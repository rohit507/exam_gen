
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../../assets/images/favicon.png" rel="shortcut icon"/>
<meta content="mkdocs-1.1.2, mkdocs-material-6.1.0" name="generator"/>
<title>PrepareAttrs - UCB EECS Exam Generator</title>
<link href="../../assets/stylesheets/main.bc7e593a.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.ab28b872.min.css" rel="stylesheet"/>
<meta content="#2094f3" name="theme-color"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
</head>
<body data-md-color-accent="" data-md-color-primary="blue" data-md-color-scheme="slate" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#prepareattrs-metaclass">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header-nav md-grid">
<a aria-label="UCB EECS Exam Generator" class="md-header-nav__button md-logo" href="../.." title="UCB EECS Exam Generator">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"></path></svg>
</a>
<label class="md-header-nav__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header-nav__title" data-md-component="header-title">
<div class="md-header-nav__ellipsis">
<span class="md-header-nav__topic md-ellipsis">
            UCB EECS Exam Generator
          </span>
<span class="md-header-nav__topic md-ellipsis">
            
              PrepareAttrs
            
          </span>
</div>
</div>
<label class="md-header-nav__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" data-md-state="active" name="query" placeholder="Search" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<button aria-label="Clear" class="md-search__icon md-icon" data-md-component="search-reset" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="UCB EECS Exam Generator" class="md-nav__button md-logo" href="../.." title="UCB EECS Exam Generator">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"></path></svg>
</a>
    UCB EECS Exam Generator
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../index.html">
      Home
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../getting-started.html">
      Getting Started
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../misc-notes.html">
      Miscellaneous Notes
    </a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="nav-4" id="nav-4" type="checkbox"/>
<label class="md-nav__link" for="nav-4">
      Developer API
      <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Developer API" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="nav-4">
<span class="md-nav__icon md-icon"></span>
        Developer API
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="nav-4-1" id="nav-4-1" type="checkbox"/>
<label class="md-nav__link" for="nav-4-1">
      Mixins
      <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Mixins" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="nav-4-1">
<span class="md-nav__icon md-icon"></span>
        Mixins
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="settings.html">
      Settings
    </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
        PrepareAttrs
        <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="prepare_attrs.html">
      PrepareAttrs
    </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#generated-documentation">
    Generated Documentation
  </a>
<nav aria-label="Generated Documentation" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#exam_gen.mixins.prepare_attrs.PrepareAttrs">
    PrepareAttrs
  </a>
<nav aria-label="PrepareAttrs" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#exam_gen.mixins.prepare_attrs.PrepareAttrs.__prepare_attrs__">
    __prepare_attrs__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#exam_gen.mixins.prepare_attrs.PrepareAttrs.get_future_mro">
    get_future_mro()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#exam_gen.mixins.prepare_attrs.PrepareAttrs.get_stub_class">
    get_stub_class()
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#creating-pre-init-class-attributes">
    Creating pre-init class attributes
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#using-prepare_attrs-in-a-dsl">
    Using prepare_attrs in a DSL
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#overloading-prepare_attrs">
    Overloading prepare_attrs
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#putting-it-all-together">
    Putting it all together
  </a>
<nav aria-label="Putting it all together" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#the-metadata-class">
    The Metadata class
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#adding-classinfo-to-metadata">
    Adding ClassInfo to metadata
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#setting-metadata-values">
    Setting metadata values
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#inheritance-order-and-overloading">
    Inheritance order and overloading
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#referencing-properties-set-with-prepare_attrs">
    Referencing properties set with prepare_attrs
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#complete-example">
    Complete Example
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#generated-documentation">
    Generated Documentation
  </a>
<nav aria-label="Generated Documentation" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#exam_gen.mixins.prepare_attrs.PrepareAttrs">
    PrepareAttrs
  </a>
<nav aria-label="PrepareAttrs" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#exam_gen.mixins.prepare_attrs.PrepareAttrs.__prepare_attrs__">
    __prepare_attrs__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#exam_gen.mixins.prepare_attrs.PrepareAttrs.get_future_mro">
    get_future_mro()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#exam_gen.mixins.prepare_attrs.PrepareAttrs.get_stub_class">
    get_stub_class()
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#creating-pre-init-class-attributes">
    Creating pre-init class attributes
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#using-prepare_attrs-in-a-dsl">
    Using prepare_attrs in a DSL
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#overloading-prepare_attrs">
    Overloading prepare_attrs
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#putting-it-all-together">
    Putting it all together
  </a>
<nav aria-label="Putting it all together" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#the-metadata-class">
    The Metadata class
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#adding-classinfo-to-metadata">
    Adding ClassInfo to metadata
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#setting-metadata-values">
    Setting metadata values
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#inheritance-order-and-overloading">
    Inheritance order and overloading
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#referencing-properties-set-with-prepare_attrs">
    Referencing properties set with prepare_attrs
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#complete-example">
    Complete Example
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<h1 id="prepareattrs-metaclass">PrepareAttrs Metaclass<a class="headerlink" href="#prepareattrs-metaclass" title="Permanent link">¶</a></h1>
<p>This metaclass makes it easier to control and manipulate the variables available 
during the class definition process, and has a lot of utility in making class-based 
EDSLs more elegant. </p>
<p>Python already has the <code>__init_subclass__</code> and <code>__dict__</code> mechanisms for working 
with declaration statements in a class definition. These are great, but they're only
capable of handling the environment of a class after a user has interacted with it. 
<code>PrepareAttrs</code> gives EDSL authors a way to prepare that environment beforehand and 
get a lot of additional power. </p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Only the final section has a full example. The other sections of this page use
working but flawed examples to build up necessary information needed to 
understand the full function of the final example. </p>
</div>
<h2 id="generated-documentation">Generated Documentation<a class="headerlink" href="#generated-documentation" title="Permanent link">¶</a></h2>
<div class="doc doc-object doc-module">
<div class="doc doc-contents first">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="exam_gen.mixins.prepare_attrs.PrepareAttrs">
<code>PrepareAttrs</code>
<a class="headerlink" href="#exam_gen.mixins.prepare_attrs.PrepareAttrs" title="Permanent link">¶</a></h3>
<div class="doc doc-contents">
<p>Classes using this metaclass can define a <code>__prepare_attrs__</code> class method to
manipulate the attributes available during the definition of any <em>child</em>
classes.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="exam_gen.mixins.prepare_attrs.PrepareAttrs.__prepare_attrs__">
<code class="highlight language-python">
__prepare_attrs__<span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#exam_gen.mixins.prepare_attrs.PrepareAttrs.__prepare_attrs__" title="Permanent link">¶</a></h4>
<div class="doc doc-contents">
<p>Define this function in classes using this metaclass to manipulate the
attributes available in subclass definitions.</p>
<details class="important" open="open"><summary>Important</summary><p>Any function defining <code>__prepare_attrs__</code> should make sure it's
idempotent in the <code>attrs</code> dictionary. Equivalently, the
following should work for all possible <code>name</code>,<code>bases</code>,and <code>attrs</code>:</p>
<div class="highlight">
<pre><span></span><code>  <span class="n">prep_attrs</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">a</span> <span class="p">:</span> <span class="n">YourClass</span><span class="o">.</span><span class="n">__prepare_attrs__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">bases</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>

  <span class="k">assert</span><span class="p">(</span><span class="n">prep_attrs</span><span class="p">(</span><span class="n">attrs</span><span class="p">)</span> <span class="o">==</span> <span class="n">prep_attrs</span><span class="p">(</span><span class="n">prep_attrs</span><span class="p">(</span><span class="n">attrs</span><span class="p">)))</span>
</code></pre>
</div>
</details>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>str</code></td>
<td>
<p>The name of the class being created</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>bases</code></td>
<td><code>list</code></td>
<td>
<p>list of classes this class is derived from</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>attrs</code></td>
<td><code>dict</code></td>
<td>
<p>The attributes defined by previous classes in the mro</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dict</code></td>
<td>
<p>The edited <code>attrs</code> dictionary that will be available to child
classes as they're defined. The simplest possible version will just
return the argument directly.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="exam_gen.mixins.prepare_attrs.PrepareAttrs.get_future_mro">
<code class="highlight language-python">
get_future_mro<span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
<a class="headerlink" href="#exam_gen.mixins.prepare_attrs.PrepareAttrs.get_future_mro" title="Permanent link">¶</a></h4>
<div class="doc doc-contents">
<p>Method to get the mro of a potential new class without triggering a
number of class initialization and metaclass side-effects. Results are
cached internal to the <code>PrepareAttrs</code> class object.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>str</code></td>
<td>
<p>The name of the class you're getting an mro for</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>bases</code></td>
<td><code>tuple</code></td>
<td>
<p>A tuple of all the classes that the new one
will directly inherit from.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>The mro that a hypothetical class with the given
   bases would have. </p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="exam_gen.mixins.prepare_attrs.PrepareAttrs.get_stub_class">
<code class="highlight language-python">
get_stub_class<span class="p">(</span><span class="bp">cls</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
<a class="headerlink" href="#exam_gen.mixins.prepare_attrs.PrepareAttrs.get_stub_class" title="Permanent link">¶</a></h4>
<div class="doc doc-contents">
<p>Creates/retrieves a class object that is a side effect free version
of another class.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>cls</code></td>
<td><code>class</code></td>
<td>
<p>An external class</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>class</code></td>
<td>
<p>An 'empty' stub with an identical mro to the parent class.
    This is cached and so will return the same stub class each time
    it's called on another class. </p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<h2 id="creating-pre-init-class-attributes">Creating pre-init class attributes<a class="headerlink" href="#creating-pre-init-class-attributes" title="Permanent link">¶</a></h2>
<p>We can use <code>PrepareAttrs</code> to magically make a useful attribute </p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Test</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">PrepareAttrs</span><span class="p">):</span>

  <span class="nd">@classmethod</span>
  <span class="k">def</span> <span class="nf">__prepare_attrs__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">bases</span><span class="p">,</span><span class="n">env</span><span class="p">):</span>
     <span class="n">env</span><span class="p">[</span><span class="s1">'test_var'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span>
     <span class="k">return</span> <span class="n">env</span> 
</code></pre></div>
<p>Now any classes that derive from <code>Test</code> can use <code>test_var</code> within their class
definition, ala:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Subtest</span><span class="p">(</span><span class="n">Test</span><span class="p">):</span>

   <span class="n">subtest_var</span> <span class="o">=</span> <span class="n">test_var</span> <span class="o">+</span> <span class="mi">20</span>

   <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="nb">print</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">test_var</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">subtest_var</span><span class="p">))</span>

<span class="n">Subtest</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span> 
</code></pre></div>
<p>The whole thing when run should print <code>(15,35)</code>. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>test_var</code> and <code>subtest_var</code> become properties of the <code>Subtest</code>
<em>class</em>, not any particular subtest object. If you're using a mutable 
value like a dictionary then updates will be shared between all the 
various objects involved unless you copy them in the object's <code>__new__</code> 
or <code>__init__</code> functions. </p>
</div>
<h2 id="using-prepare_attrs-in-a-dsl">Using <code>prepare_attrs</code> in a DSL<a class="headerlink" href="#using-prepare_attrs-in-a-dsl" title="Permanent link">¶</a></h2>
<p>In general this is meant to be used along with <code>__init_subclass__</code> to enable
more declarative DSLs in python, by allowing users to assign and manipulate 
terms directly in their new class definitions </p>
<p>Here we're creating a rather contrived exampled where we allow subclasses to 
work with options directly and then validate them after the fact. </p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">ValidateOptions</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">PrepareAttrs</span><span class="p">):</span>


  <span class="nd">@classmethod</span>
  <span class="k">def</span> <span class="nf">__prepare_attrs__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">bases</span><span class="p">,</span><span class="n">env</span><span class="p">):</span>
     <span class="n">env</span><span class="p">[</span><span class="s1">'do_this'</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
     <span class="n">env</span><span class="p">[</span><span class="s1">'do_that'</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
     <span class="n">env</span><span class="p">[</span><span class="s1">'do_both'</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
     <span class="k">return</span> <span class="n">env</span>

  <span class="nd">@classmethod</span>
  <span class="k">def</span> <span class="nf">__init_subclass__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

     <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init_subclass__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

     <span class="n">do_this</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">'do_this'</span><span class="p">]</span>
     <span class="n">do_that</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">'do_that'</span><span class="p">]</span>
     <span class="n">do_both</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">'do_both'</span><span class="p">]</span>

     <span class="k">if</span> <span class="p">(</span><span class="n">do_this</span> <span class="ow">and</span> <span class="n">do_that</span><span class="p">)</span> <span class="o">!=</span> <span class="n">do_both</span><span class="p">:</span>
       <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">"Invalid Class Options"</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Test1</span><span class="p">(</span><span class="n">ValidateOptions</span><span class="p">):</span>
  <span class="n">do_this</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="n">do_both</span> <span class="o">=</span> <span class="n">do_this</span> <span class="ow">and</span> <span class="n">do_that</span>

<span class="k">class</span> <span class="nc">Test2</span><span class="p">(</span><span class="n">ValidateOptions</span><span class="p">):</span>
  <span class="n">do_both</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div>
<p>Notice how the user can both update and refer to settings information in their
class definitions. This opens up the class definition as a place for declarations
instead of just defining functions. Classes provide a nice modular grouping for 
your users as they interact with whatever system you're building a DSL for.</p>
<p>That said, this example does have a few issues: </p>
<ul>
<li>
<p>The first issue is inheritance of properties. Consider adding the following 
    class to our example: </p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Test3</span><span class="p">(</span><span class="n">Test1</span><span class="p">):</span> 
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
    <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">do_this</span><span class="p">)</span> 

<span class="n">Test3</span><span class="p">()</span>
</code></pre></div>
<p>It would print <code>True</code> on init despite our <code>Test1</code> class overriding the 
definition for <code>do_this</code>. 
  - Similarly, out current setup doesn't take into account what happens when
a child class overloads <code>__prepare_attr__</code>. In particular if we have the 
following: </p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Test4</span><span class="p">(</span><span class="n">ValidateOptions</span><span class="p">):</span> 

  <span class="nd">@classmethod</span>
  <span class="k">def</span> <span class="nf">__prepare_attrs__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">bases</span><span class="p">,</span><span class="n">env</span><span class="p">):</span>
     <span class="n">env</span><span class="p">[</span><span class="s1">'something'</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
     <span class="k">return</span> <span class="n">env</span>

<span class="k">class</span> <span class="nc">Test5</span><span class="p">(</span><span class="n">Test4</span><span class="p">):</span>
  <span class="n">var</span> <span class="o">=</span> <span class="n">do_this</span>
</code></pre></div>
<p>We will get an error because <code>do_this</code> isn't defined into the context of 
<code>Test5</code>. </p>
</li>
</ul>
<p>We'll discuss how to deal with these issues in the next few examples. </p>
<h2 id="overloading-prepare_attrs">Overloading <code>prepare_attrs</code><a class="headerlink" href="#overloading-prepare_attrs" title="Permanent link">¶</a></h2>
<p>Before we deal with properly inheriting user made changes, we should look at 
how various calls to <code>prepare_attr</code> are handled when we have a sequence of 
classes inheriting from each other. </p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">exam_gen.mixins.prepare_attrs</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">Base</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">PrepareAttrs</span><span class="p">):</span>

  <span class="nd">@classmethod</span>
  <span class="k">def</span> <span class="nf">__prepare_attrs__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">bases</span><span class="p">,</span><span class="n">env</span><span class="p">):</span>
     <span class="nb">print</span><span class="p">((</span><span class="n">name</span><span class="p">,</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="s2">"Base.__prepare_attrs__"</span><span class="p">))</span>
     <span class="k">return</span> <span class="n">env</span>

<span class="k">class</span> <span class="nc">Test1</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span> <span class="k">pass</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span> <span class="c1"># Space out print statements</span>

<span class="k">class</span> <span class="nc">Test2</span><span class="p">(</span><span class="n">Test1</span><span class="p">):</span>

  <span class="nd">@classmethod</span>
  <span class="k">def</span> <span class="nf">__prepare_attrs__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">bases</span><span class="p">,</span><span class="n">env</span><span class="p">):</span>
    <span class="n">env</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__prepare_attrs__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">bases</span><span class="p">,</span><span class="n">env</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">((</span><span class="n">name</span><span class="p">,</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="s2">"Test2.__prepare_attrs__"</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">env</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span> <span class="c1"># Space out print statements</span>

<span class="k">class</span> <span class="nc">Test3</span><span class="p">(</span><span class="n">Test2</span><span class="p">):</span> <span class="k">pass</span>
</code></pre></div>
<p>When run, the above example should print the following: </p>
<div class="highlight"><pre><span></span><code><span class="o">(</span><span class="s1">'Test1'</span>, <span class="s1">'Base'</span>, <span class="s1">'Base.__prepare_attrs__'</span><span class="o">)</span>

<span class="o">(</span><span class="s1">'Test2'</span>, <span class="s1">'Base'</span>, <span class="s1">'Base.__prepare_attrs__'</span><span class="o">)</span>
<span class="o">(</span><span class="s1">'Test2'</span>, <span class="s1">'Test1'</span>, <span class="s1">'Base.__prepare_attrs__'</span><span class="o">)</span>

<span class="o">(</span><span class="s1">'Test3'</span>, <span class="s1">'Base'</span>, <span class="s1">'Base.__prepare_attrs__'</span><span class="o">)</span>
<span class="o">(</span><span class="s1">'Test3'</span>, <span class="s1">'Test1'</span>, <span class="s1">'Base.__prepare_attrs__'</span><span class="o">)</span>
<span class="o">(</span><span class="s1">'Test3'</span>, <span class="s1">'Test2'</span>, <span class="s1">'Base.__prepare_attrs__'</span><span class="o">)</span>
<span class="o">(</span><span class="s1">'Test3'</span>, <span class="s1">'Test2'</span>, <span class="s1">'Test2.__prepare_attrs__'</span><span class="o">)</span>
</code></pre></div>
<p>The first line of that output means "While generating the attrs for <code>Test1</code> 
we are calling <code>Base.__prepare_attrs__</code> with a class parameter of <code>Base</code>." 
and likewise for the rest of the lines. </p>
<p>As expected, <code>Test 1</code> has a single call from <code>Base</code>'s definition of 
<code>prepare_attrs</code>, which has access to the post-initialization version of the 
<code>Base</code> class. </p>
<p>Looking at <code>Test2</code>'s calls we see something interesting. There are two separate
calls to <code>Base.__prepare_attrs__</code>, that have access to the post-init class 
definitions of <code>Base</code> and <code>Test1</code>. <strong>We can use this to implement overloading.</strong>
This is also why we ask for idempotence in your definitions of <code>__prepare_attrs__</code>. </p>
<p>Finally, we can take a look at <code>Test3</code>'s initialization: </p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="s1">'Test3'</span><span class="p">,</span> <span class="s1">'Base'</span><span class="p">,</span> <span class="s1">'Base.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test3'</span><span class="p">,</span> <span class="s1">'Test1'</span><span class="p">,</span> <span class="s1">'Base.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test3'</span><span class="p">,</span> <span class="s1">'Test2'</span><span class="p">,</span> <span class="s1">'Base.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test3'</span><span class="p">,</span> <span class="s1">'Test2'</span><span class="p">,</span> <span class="s1">'Test2.__prepare_attrs__'</span><span class="p">)</span>
</code></pre></div>
<p>This is what we want. Whatever preparation <code>Base.__prepare_attrs__</code> does, it 
gets to do that prep for every class in <code>Test3</code>'s lineage. Likewise 
<code>Test2.__prepare_attrs__</code> gets to do that prep for <code>Test3</code>'s environment. </p>
<p>This is all because of that call to <code>super()</code> and without it we would get 
the following: </p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="s1">'Test3'</span><span class="p">,</span> <span class="s1">'Base'</span><span class="p">,</span> <span class="s1">'Base.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test3'</span><span class="p">,</span> <span class="s1">'Test1'</span><span class="p">,</span> <span class="s1">'Base.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test3'</span><span class="p">,</span> <span class="s1">'Test2'</span><span class="p">,</span> <span class="s1">'Test2.__prepare_attrs__'</span><span class="p">)</span>
</code></pre></div>
<p>And completely forgo <code>('Test3', 'Test2', 'Base.__prepare_attrs__')</code> and the 
corresponding call to <code>Base.__prepare_attrs__</code>. Meaning that any changes 
to <code>Test2</code> that are handled by <code>Base</code>'s handler would be missing. This would
break any effort to update terms at each successive definition. </p>
<h2 id="putting-it-all-together">Putting it all together<a class="headerlink" href="#putting-it-all-together" title="Permanent link">¶</a></h2>
<p>So we're going to be making two classes that allow people to define and 
manipulate metadata about a class. Together they should provide a full example
of how to use <code>PrepareAttrs</code> properly. </p>
<h3 id="the-metadata-class">The <code>Metadata</code> class<a class="headerlink" href="#the-metadata-class" title="Permanent link">¶</a></h3>
<p>The <code>Metadata</code> class allows the user to work with a single variable at class 
definition time, <code>metadata</code> which is a standard dictionary the user can edit. 
It uses <code>__prepare_attrs__</code> to prepare the class environment, then in 
<code>__init_subclass__</code> it prints that environment out to console. </p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">exam_gen.mixins.prepare_attrs</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">Metadata</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">PrepareAttrs</span><span class="p">):</span>

  <span class="nd">@classmethod</span>
  <span class="k">def</span> <span class="nf">__prepare_attrs__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">bases</span><span class="p">,</span><span class="n">env</span><span class="p">):</span>
     <span class="nb">print</span><span class="p">((</span><span class="n">name</span><span class="p">,</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="s2">"Metadata.__prepare_attrs__"</span><span class="p">))</span>
     <span class="c1"># Call metadata for superclasses if needed </span>
     <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="nb">super</span><span class="p">(),</span><span class="s2">"__prepare_attrs__"</span><span class="p">):</span>
       <span class="n">env</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__prepare_attrs__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">bases</span><span class="p">,</span><span class="n">env</span><span class="p">)</span>

     <span class="c1"># If we don't have any metadata create it</span>
     <span class="k">if</span> <span class="s1">'metadata'</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">env</span><span class="p">:</span>
       <span class="n">env</span><span class="p">[</span><span class="s1">'metadata'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

     <span class="c1"># If the metadata has been changed in a class then</span>
     <span class="c1"># we can update it here. </span>
     <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="s1">'metadata'</span><span class="p">):</span>
       <span class="n">env</span><span class="p">[</span><span class="s1">'metadata'</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>

     <span class="k">return</span> <span class="n">env</span>

  <span class="nd">@classmethod</span>
  <span class="k">def</span> <span class="nf">__init_subclass__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">((</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="s2">"ClassInfo.__init_subclass__"</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="s2">"metadata"</span><span class="p">):</span>
      <span class="n">pprint</span><span class="p">({</span>
        <span class="s1">'Class'</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
        <span class="s1">'mro'</span><span class="p">:</span> <span class="p">[</span><span class="n">par</span><span class="o">.</span><span class="vm">__qualname__</span> <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__mro__</span><span class="p">],</span>
        <span class="s1">'Metadata at __init__'</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">metadata</span>
      <span class="p">})</span>
</code></pre></div>
<p>As <code>__init_subclass__</code> amounts to a bunch of print statements
we can focus on <code>__prepare_attrs__</code>. It meets the basic criteria 
we found in previous sections: </p>
<ul>
<li>Properly calls <code>super().__prepare_attrs__</code> and keeps any updates
    that superclasses make to <code>env</code>. </li>
<li>Does not re-initialize values in <code>env</code> if they already exist.</li>
<li>Incorporates post-initialization changes from the <code>cls</code> parameter
    if they exist. (here via <code>Dict.update()</code> though other examples 
    will probably be more complex. </li>
<li>Returns the new modified <code>env</code> when finished. </li>
</ul>
<h3 id="adding-classinfo-to-metadata">Adding <code>ClassInfo</code> to <code>metadata</code><a class="headerlink" href="#adding-classinfo-to-metadata" title="Permanent link">¶</a></h3>
<p>This class inherits from <code>Metadata</code> and is largely identical. The only 
exceptions are a different print statement at the beginning and how
instead of updating the metadata with each class call, it adds some 
information about parent classes: </p>
<div class="highlight"><pre><span></span><code><span class="n">env</span><span class="p">[</span><span class="s1">'metadata'</span><span class="p">][</span><span class="s1">'Base Classes'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">base</span><span class="o">.</span><span class="vm">__qualname__</span> <span class="k">for</span> <span class="n">base</span> <span class="ow">in</span> <span class="n">bases</span><span class="p">]</span>
</code></pre></div>
<p>Initializing this class produces the following output: </p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="s1">'ClassInfo'</span><span class="p">,</span> <span class="s1">'Metadata'</span><span class="p">,</span> <span class="s1">'Metadata.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'ClassInfo'</span><span class="p">,</span> <span class="s1">'ClassInfo.__init_subclass__'</span><span class="p">)</span>
<span class="p">{</span><span class="s1">'Class'</span><span class="p">:</span> <span class="s1">'ClassInfo'</span><span class="p">,</span>
 <span class="s1">'Metadata at __init__'</span><span class="p">:</span> <span class="p">{},</span>
 <span class="s1">'mro'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'ClassInfo'</span><span class="p">,</span> <span class="s1">'Metadata'</span><span class="p">,</span> <span class="s1">'object'</span><span class="p">]}</span>
</code></pre></div>
<p>Which has the expected calls to <code>Metadata.__prepare_attrs__</code>, and since 
you can't call <code>ClassInfo.__prepare_attrs__</code> before there's a <code>ClassInfo</code> 
object there's no changes to the metadata other than the fact it exists.</p>
<h3 id="setting-metadata-values">Setting metadata values<a class="headerlink" href="#setting-metadata-values" title="Permanent link">¶</a></h3>
<p>Then we have <code>Test1</code>, <code>Test2</code>, and <code>Test3</code>, which only set some metadata
values: </p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Test1</span><span class="p">(</span><span class="n">Metadata</span><span class="p">):</span>
  <span class="n">metadata</span><span class="p">[</span><span class="s1">'Name'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Walter"</span>

<span class="k">class</span> <span class="nc">Test2</span><span class="p">(</span><span class="n">Metadata</span><span class="p">):</span>
  <span class="n">metadata</span><span class="p">[</span><span class="s1">'Count'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>

<span class="k">class</span> <span class="nc">Test3</span><span class="p">(</span><span class="n">Metadata</span><span class="p">):</span>
  <span class="n">metadata</span><span class="p">[</span><span class="s1">'Name'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Beeswax"</span>
</code></pre></div>
<p>And the corresponding output only shows that the values are set, and 
is otherwise uninteresting: </p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="s1">'Test1'</span><span class="p">,</span> <span class="s1">'Metadata'</span><span class="p">,</span> <span class="s1">'Metadata.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test1'</span><span class="p">,</span> <span class="s1">'ClassInfo.__init_subclass__'</span><span class="p">)</span>
<span class="p">{</span><span class="s1">'Class'</span><span class="p">:</span> <span class="s1">'Test1'</span><span class="p">,</span>
 <span class="s1">'Metadata at __init__'</span><span class="p">:</span> <span class="p">{</span><span class="s1">'Name'</span><span class="p">:</span> <span class="s1">'Walter'</span><span class="p">},</span>
 <span class="s1">'mro'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Test1'</span><span class="p">,</span> <span class="s1">'Metadata'</span><span class="p">,</span> <span class="s1">'object'</span><span class="p">]}</span>

<span class="p">(</span><span class="s1">'Test2'</span><span class="p">,</span> <span class="s1">'Metadata'</span><span class="p">,</span> <span class="s1">'Metadata.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test2'</span><span class="p">,</span> <span class="s1">'ClassInfo.__init_subclass__'</span><span class="p">)</span>
<span class="p">{</span><span class="s1">'Class'</span><span class="p">:</span> <span class="s1">'Test2'</span><span class="p">,</span>
 <span class="s1">'Metadata at __init__'</span><span class="p">:</span> <span class="p">{</span><span class="s1">'Count'</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
 <span class="s1">'mro'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Test2'</span><span class="p">,</span> <span class="s1">'Metadata'</span><span class="p">,</span> <span class="s1">'object'</span><span class="p">]}</span>

<span class="p">(</span><span class="s1">'Test3'</span><span class="p">,</span> <span class="s1">'Metadata'</span><span class="p">,</span> <span class="s1">'Metadata.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test3'</span><span class="p">,</span> <span class="s1">'ClassInfo.__init_subclass__'</span><span class="p">)</span>
<span class="p">{</span><span class="s1">'Class'</span><span class="p">:</span> <span class="s1">'Test3'</span><span class="p">,</span>
 <span class="s1">'Metadata at __init__'</span><span class="p">:</span> <span class="p">{</span><span class="s1">'Name'</span><span class="p">:</span> <span class="s1">'Beeswax'</span><span class="p">},</span>
 <span class="s1">'mro'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Test3'</span><span class="p">,</span> <span class="s1">'Metadata'</span><span class="p">,</span> <span class="s1">'object'</span><span class="p">]}</span>
</code></pre></div>
<h3 id="inheritance-order-and-overloading">Inheritance order and overloading<a class="headerlink" href="#inheritance-order-and-overloading" title="Permanent link">¶</a></h3>
<p>One of python's quirks is that the order of parent classes in your class
declaration breaks ties in overloading. We want our metadata overloading 
system to have the same behavior. Both <code>Test1</code> and <code>Test3</code> define <code>name</code> 
so we can test this with the following: </p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Test4</span><span class="p">(</span><span class="n">Test1</span><span class="p">,</span><span class="n">Test3</span><span class="p">):</span> <span class="k">pass</span>

<span class="k">class</span> <span class="nc">Test5</span><span class="p">(</span><span class="n">Test3</span><span class="p">,</span><span class="n">Test1</span><span class="p">,</span><span class="n">ClassInfo</span><span class="p">):</span> <span class="k">pass</span>
</code></pre></div>
<p>Which produces the following output: </p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="s1">'Test4'</span><span class="p">,</span> <span class="s1">'Metadata'</span><span class="p">,</span> <span class="s1">'Metadata.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test4'</span><span class="p">,</span> <span class="s1">'Test3'</span><span class="p">,</span> <span class="s1">'Metadata.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test4'</span><span class="p">,</span> <span class="s1">'Test1'</span><span class="p">,</span> <span class="s1">'Metadata.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test4'</span><span class="p">,</span> <span class="s1">'ClassInfo.__init_subclass__'</span><span class="p">)</span>
<span class="p">{</span><span class="s1">'Class'</span><span class="p">:</span> <span class="s1">'Test4'</span><span class="p">,</span>
 <span class="s1">'Metadata at __init__'</span><span class="p">:</span> <span class="p">{</span><span class="s1">'Name'</span><span class="p">:</span> <span class="s1">'Walter'</span><span class="p">},</span>
 <span class="s1">'mro'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Test4'</span><span class="p">,</span> <span class="s1">'Test1'</span><span class="p">,</span> <span class="s1">'Test3'</span><span class="p">,</span> <span class="s1">'Metadata'</span><span class="p">,</span> <span class="s1">'object'</span><span class="p">]}</span>

<span class="p">(</span><span class="s1">'Test5'</span><span class="p">,</span> <span class="s1">'Metadata'</span><span class="p">,</span> <span class="s1">'Metadata.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test5'</span><span class="p">,</span> <span class="s1">'ClassInfo'</span><span class="p">,</span> <span class="s1">'ClassInfo.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test5'</span><span class="p">,</span> <span class="s1">'ClassInfo'</span><span class="p">,</span> <span class="s1">'Metadata.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test5'</span><span class="p">,</span> <span class="s1">'Test1'</span><span class="p">,</span> <span class="s1">'Metadata.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test5'</span><span class="p">,</span> <span class="s1">'Test3'</span><span class="p">,</span> <span class="s1">'Metadata.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test5'</span><span class="p">,</span> <span class="s1">'ClassInfo.__init_subclass__'</span><span class="p">)</span>
<span class="p">{</span><span class="s1">'Class'</span><span class="p">:</span> <span class="s1">'Test5'</span><span class="p">,</span>
 <span class="s1">'Metadata at __init__'</span><span class="p">:</span> <span class="p">{</span><span class="s1">'Base Classes'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Test3'</span><span class="p">,</span> <span class="s1">'Test1'</span><span class="p">,</span> <span class="s1">'ClassInfo'</span><span class="p">],</span>
                          <span class="s1">'Name'</span><span class="p">:</span> <span class="s1">'Beeswax'</span><span class="p">},</span>
 <span class="s1">'mro'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Test5'</span><span class="p">,</span> <span class="s1">'Test3'</span><span class="p">,</span> <span class="s1">'Test1'</span><span class="p">,</span> <span class="s1">'ClassInfo'</span><span class="p">,</span> <span class="s1">'Metadata'</span><span class="p">,</span> <span class="s1">'object'</span><span class="p">]}</span>
</code></pre></div>
<p>Note how the correct name ends up being set in the metadata. In addition
<code>Test5</code> has both <code>ClassInfo</code> and <code>Metadata</code> correctly called during 
prep phase. </p>
<h3 id="referencing-properties-set-with-prepare_attrs">Referencing properties set with <code>prepare_attrs</code><a class="headerlink" href="#referencing-properties-set-with-prepare_attrs" title="Permanent link">¶</a></h3>
<p>The following test cases access information within the metadata in addition
to manipulating it. <code>Test6</code> uses <code>+=</code> to read and increment a value, similar 
functions could allow for many interesting and complex interactions in EDSLs. 
<code>Test7</code> on the other hand is a simple test that confirms the class declaration
environment functions just like any other imperative code environment. </p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Test6</span><span class="p">(</span><span class="n">Test1</span><span class="p">,</span><span class="n">Test2</span><span class="p">):</span>
  <span class="n">metadata</span><span class="p">[</span><span class="s1">'Count'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">8</span>

<span class="k">class</span> <span class="nc">Test7</span><span class="p">(</span><span class="n">Test6</span><span class="p">,</span><span class="n">Test5</span><span class="p">):</span>
  <span class="n">metadata</span><span class="p">[</span><span class="s1">'Fruit'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Pineapple"</span>
  <span class="n">metadata</span><span class="p">[</span><span class="s1">'Info'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Test7 has metadata for </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">metadata</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
  <span class="n">metadata</span><span class="p">[</span><span class="s1">'Pie'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Key Lime"</span>
</code></pre></div>
<p>The output for <code>Test6</code> confirms that the count from <code>Test2</code> was correctly
incremented as the class was initialized. </p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="s1">'Test6'</span><span class="p">,</span> <span class="s1">'Metadata'</span><span class="p">,</span> <span class="s1">'Metadata.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test6'</span><span class="p">,</span> <span class="s1">'Test2'</span><span class="p">,</span> <span class="s1">'Metadata.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test6'</span><span class="p">,</span> <span class="s1">'Test1'</span><span class="p">,</span> <span class="s1">'Metadata.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test6'</span><span class="p">,</span> <span class="s1">'ClassInfo.__init_subclass__'</span><span class="p">)</span>
<span class="p">{</span><span class="s1">'Class'</span><span class="p">:</span> <span class="s1">'Test6'</span><span class="p">,</span>
 <span class="s1">'Metadata at __init__'</span><span class="p">:</span> <span class="p">{</span><span class="s1">'Count'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">'Name'</span><span class="p">:</span> <span class="s1">'Walter'</span><span class="p">},</span>
 <span class="s1">'mro'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Test6'</span><span class="p">,</span> <span class="s1">'Test1'</span><span class="p">,</span> <span class="s1">'Test2'</span><span class="p">,</span> <span class="s1">'Metadata'</span><span class="p">,</span> <span class="s1">'object'</span><span class="p">]}</span>
</code></pre></div>
<p>The output for <code>Test7</code> is a bit more verbose, but we can see that <code>Pie</code> was not
included in <code>Info</code>, as <code>metadata</code> didn't have that key when the value for 
<code>Info</code> was generated. </p>
<details class="output"><summary>Output</summary><div class="highlight"><pre><span></span><code><span class="p">(</span><span class="s1">'Test7'</span><span class="p">,</span> <span class="s1">'Metadata'</span><span class="p">,</span> <span class="s1">'Metadata.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test7'</span><span class="p">,</span> <span class="s1">'ClassInfo'</span><span class="p">,</span> <span class="s1">'ClassInfo.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test7'</span><span class="p">,</span> <span class="s1">'ClassInfo'</span><span class="p">,</span> <span class="s1">'Metadata.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test7'</span><span class="p">,</span> <span class="s1">'Test2'</span><span class="p">,</span> <span class="s1">'Metadata.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test7'</span><span class="p">,</span> <span class="s1">'Test1'</span><span class="p">,</span> <span class="s1">'Metadata.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test7'</span><span class="p">,</span> <span class="s1">'Test3'</span><span class="p">,</span> <span class="s1">'Metadata.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test7'</span><span class="p">,</span> <span class="s1">'Test5'</span><span class="p">,</span> <span class="s1">'ClassInfo.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test7'</span><span class="p">,</span> <span class="s1">'Test5'</span><span class="p">,</span> <span class="s1">'Metadata.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test7'</span><span class="p">,</span> <span class="s1">'Test6'</span><span class="p">,</span> <span class="s1">'Metadata.__prepare_attrs__'</span><span class="p">)</span>
<span class="p">(</span><span class="s1">'Test7'</span><span class="p">,</span> <span class="s1">'ClassInfo.__init_subclass__'</span><span class="p">)</span>
<span class="p">{</span><span class="s1">'Class'</span><span class="p">:</span> <span class="s1">'Test7'</span><span class="p">,</span>
 <span class="s1">'Metadata at __init__'</span><span class="p">:</span> <span class="p">{</span><span class="s1">'Base Classes'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Test6'</span><span class="p">,</span> <span class="s1">'Test5'</span><span class="p">],</span>
                          <span class="s1">'Count'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                          <span class="s1">'Fruit'</span><span class="p">:</span> <span class="s1">'Pineapple'</span><span class="p">,</span>
                          <span class="s1">'Info'</span><span class="p">:</span> <span class="s2">"Test7 has metadata for dict_keys(['Base "</span>
                                  <span class="s2">"Classes', 'Count', 'Name', 'Fruit'])"</span><span class="p">,</span>
                          <span class="s1">'Name'</span><span class="p">:</span> <span class="s1">'Walter'</span><span class="p">,</span>
                          <span class="s1">'Pie'</span><span class="p">:</span> <span class="s1">'Key Lime'</span><span class="p">},</span>
 <span class="s1">'mro'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Test7'</span><span class="p">,</span>
         <span class="s1">'Test6'</span><span class="p">,</span>
         <span class="s1">'Test5'</span><span class="p">,</span>
         <span class="s1">'Test3'</span><span class="p">,</span>
         <span class="s1">'Test1'</span><span class="p">,</span>
         <span class="s1">'Test2'</span><span class="p">,</span>
         <span class="s1">'ClassInfo'</span><span class="p">,</span>
         <span class="s1">'Metadata'</span><span class="p">,</span>
         <span class="s1">'object'</span><span class="p">]}</span>
</code></pre></div>
</details>
<h3 id="complete-example">Complete Example<a class="headerlink" href="#complete-example" title="Permanent link">¶</a></h3>
<details class="example"><summary>Example</summary><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">exam_gen.mixins.prepare_attrs</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">Metadata</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">PrepareAttrs</span><span class="p">):</span>

  <span class="nd">@classmethod</span>
  <span class="k">def</span> <span class="nf">__prepare_attrs__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">bases</span><span class="p">,</span><span class="n">env</span><span class="p">):</span>
     <span class="nb">print</span><span class="p">((</span><span class="n">name</span><span class="p">,</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="s2">"Metadata.__prepare_attrs__"</span><span class="p">))</span>
     <span class="c1"># Call metadata for superclasses if needed </span>
     <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="nb">super</span><span class="p">(),</span><span class="s2">"__prepare_attrs__"</span><span class="p">):</span>
       <span class="n">env</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__prepare_attrs__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">bases</span><span class="p">,</span><span class="n">env</span><span class="p">)</span>

     <span class="c1"># If we don't have any metadata create it</span>
     <span class="k">if</span> <span class="s1">'metadata'</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">env</span><span class="p">:</span>
       <span class="n">env</span><span class="p">[</span><span class="s1">'metadata'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

     <span class="c1"># If the metadata has been changed in a class then</span>
     <span class="c1"># we can update it here. </span>
     <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="s1">'metadata'</span><span class="p">):</span>
       <span class="n">env</span><span class="p">[</span><span class="s1">'metadata'</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>

     <span class="k">return</span> <span class="n">env</span>

  <span class="nd">@classmethod</span>
  <span class="k">def</span> <span class="nf">__init_subclass__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">((</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="s2">"ClassInfo.__init_subclass__"</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="s2">"metadata"</span><span class="p">):</span>
      <span class="n">pprint</span><span class="p">({</span>
        <span class="s1">'Class'</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
        <span class="s1">'mro'</span><span class="p">:</span> <span class="p">[</span><span class="n">par</span><span class="o">.</span><span class="vm">__qualname__</span> <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__mro__</span><span class="p">],</span>
        <span class="s1">'Metadata at __init__'</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">metadata</span>
      <span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ClassInfo</span><span class="p">(</span><span class="n">Metadata</span><span class="p">):</span> 
  <span class="nd">@classmethod</span>
  <span class="k">def</span> <span class="nf">__prepare_attrs__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">bases</span><span class="p">,</span><span class="n">env</span><span class="p">):</span>
     <span class="nb">print</span><span class="p">((</span><span class="n">name</span><span class="p">,</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span><span class="s2">"ClassInfo.__prepare_attrs__"</span><span class="p">))</span>
     <span class="c1"># Call metadata for superclasses if needed </span>
     <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="nb">super</span><span class="p">(),</span><span class="s2">"__prepare_attrs__"</span><span class="p">):</span>
       <span class="n">env</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__prepare_attrs__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">bases</span><span class="p">,</span><span class="n">env</span><span class="p">)</span>

     <span class="c1"># If we don't have any metadata create it</span>
     <span class="k">if</span> <span class="s1">'metadata'</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">env</span><span class="p">:</span>
       <span class="n">env</span><span class="p">[</span><span class="s1">'metadata'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

     <span class="c1"># If the metadata has been changed in a class then</span>
     <span class="c1"># we can update it here. </span>
     <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="s1">'metadata'</span><span class="p">):</span>
       <span class="n">env</span><span class="p">[</span><span class="s1">'metadata'</span><span class="p">][</span><span class="s1">'Base Classes'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">base</span><span class="o">.</span><span class="vm">__qualname__</span> <span class="k">for</span> <span class="n">base</span> <span class="ow">in</span> <span class="n">bases</span><span class="p">]</span>

     <span class="k">return</span> <span class="n">env</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Test1</span><span class="p">(</span><span class="n">Metadata</span><span class="p">):</span>
  <span class="n">metadata</span><span class="p">[</span><span class="s1">'Name'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Walter"</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Test2</span><span class="p">(</span><span class="n">Metadata</span><span class="p">):</span>
  <span class="n">metadata</span><span class="p">[</span><span class="s1">'Count'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Test3</span><span class="p">(</span><span class="n">Metadata</span><span class="p">):</span>
  <span class="n">metadata</span><span class="p">[</span><span class="s1">'Name'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Beeswax"</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Test4</span><span class="p">(</span><span class="n">Test1</span><span class="p">,</span><span class="n">Test3</span><span class="p">):</span> <span class="k">pass</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Test5</span><span class="p">(</span><span class="n">Test3</span><span class="p">,</span><span class="n">Test1</span><span class="p">,</span><span class="n">ClassInfo</span><span class="p">):</span> <span class="k">pass</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Test6</span><span class="p">(</span><span class="n">Test1</span><span class="p">,</span><span class="n">Test2</span><span class="p">):</span>
  <span class="n">metadata</span><span class="p">[</span><span class="s1">'Count'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">8</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Test7</span><span class="p">(</span><span class="n">Test6</span><span class="p">,</span><span class="n">Test5</span><span class="p">):</span>
  <span class="n">metadata</span><span class="p">[</span><span class="s1">'Fruit'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Pineapple"</span>
  <span class="n">metadata</span><span class="p">[</span><span class="s1">'Info'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Test7 has metadata for </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">metadata</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
  <span class="n">metadata</span><span class="p">[</span><span class="s1">'Pie'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Key Lime"</span>
</code></pre></div>
</details>
<details class="output"><summary>Output</summary><div class="highlight"><pre><span></span><code>('ClassInfo', 'Metadata', 'Metadata.__prepare_attrs__')
('ClassInfo', 'ClassInfo.__init_subclass__')
{'Class': 'ClassInfo',
 'Metadata at __init__': {},
 'mro': ['ClassInfo', 'Metadata', 'object']}

('Test1', 'Metadata', 'Metadata.__prepare_attrs__')
('Test1', 'ClassInfo.__init_subclass__')
{'Class': 'Test1',
 'Metadata at __init__': {'Name': 'Walter'},
 'mro': ['Test1', 'Metadata', 'object']}

('Test2', 'Metadata', 'Metadata.__prepare_attrs__')
('Test2', 'ClassInfo.__init_subclass__')
{'Class': 'Test2',
 'Metadata at __init__': {'Count': 2},
 'mro': ['Test2', 'Metadata', 'object']}

('Test3', 'Metadata', 'Metadata.__prepare_attrs__')
('Test3', 'ClassInfo.__init_subclass__')
{'Class': 'Test3',
 'Metadata at __init__': {'Name': 'Beeswax'},
 'mro': ['Test3', 'Metadata', 'object']}

('Test4', 'Metadata', 'Metadata.__prepare_attrs__')
('Test4', 'Test3', 'Metadata.__prepare_attrs__')
('Test4', 'Test1', 'Metadata.__prepare_attrs__')
('Test4', 'ClassInfo.__init_subclass__')
{'Class': 'Test4',
 'Metadata at __init__': {'Name': 'Walter'},
 'mro': ['Test4', 'Test1', 'Test3', 'Metadata', 'object']}

('Test5', 'Metadata', 'Metadata.__prepare_attrs__')
('Test5', 'ClassInfo', 'ClassInfo.__prepare_attrs__')
('Test5', 'ClassInfo', 'Metadata.__prepare_attrs__')
('Test5', 'Test1', 'Metadata.__prepare_attrs__')
('Test5', 'Test3', 'Metadata.__prepare_attrs__')
('Test5', 'ClassInfo.__init_subclass__')
{'Class': 'Test5',
 'Metadata at __init__': {'Base Classes': ['Test3', 'Test1', 'ClassInfo'],
                          'Name': 'Beeswax'},
 'mro': ['Test5', 'Test3', 'Test1', 'ClassInfo', 'Metadata', 'object']}

('Test6', 'Metadata', 'Metadata.__prepare_attrs__')
('Test6', 'Test2', 'Metadata.__prepare_attrs__')
('Test6', 'Test1', 'Metadata.__prepare_attrs__')
('Test6', 'ClassInfo.__init_subclass__')
{'Class': 'Test6',
 'Metadata at __init__': {'Count': 10, 'Name': 'Walter'},
 'mro': ['Test6', 'Test1', 'Test2', 'Metadata', 'object']}

('Test7', 'Metadata', 'Metadata.__prepare_attrs__')
('Test7', 'ClassInfo', 'ClassInfo.__prepare_attrs__')
('Test7', 'ClassInfo', 'Metadata.__prepare_attrs__')
('Test7', 'Test2', 'Metadata.__prepare_attrs__')
('Test7', 'Test1', 'Metadata.__prepare_attrs__')
('Test7', 'Test3', 'Metadata.__prepare_attrs__')
('Test7', 'Test5', 'ClassInfo.__prepare_attrs__')
('Test7', 'Test5', 'Metadata.__prepare_attrs__')
('Test7', 'Test6', 'Metadata.__prepare_attrs__')
('Test7', 'ClassInfo.__init_subclass__')
{'Class': 'Test7',
 'Metadata at __init__': {'Base Classes': ['Test6', 'Test5'],
                          'Count': 10,
                          'Fruit': 'Pineapple',
                          'Info': "Test7 has metadata for dict_keys(['Base "
                                  "Classes', 'Count', 'Name', 'Fruit'])",
                          'Name': 'Walter',
                          'Pie': 'Key Lime'},
 'mro': ['Test7',
         'Test6',
         'Test5',
         'Test3',
         'Test1',
         'Test2',
         'ClassInfo',
         'Metadata',
         'object']}
</code></pre></div>
</details>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav aria-label="Footer" class="md-footer-nav__inner md-grid">
<a class="md-footer-nav__link md-footer-nav__link--prev" href="settings.html" rel="prev">
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Previous
                </span>
                Settings
              </div>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs
        </a>
</div>
</div>
</div>
</footer>
</div>
<script src="../../assets/javascripts/vendor.6a3d08fc.min.js"></script>
<script src="../../assets/javascripts/bundle.71201edf.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
<script src="../../theme/js/iframe-worker.js"></script>
<script src="../../search/search_index.js"></script>
<script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
</body>
</html>